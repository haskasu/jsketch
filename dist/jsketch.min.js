!function(t){function e(t,e){if(t)return"string"==typeof t&&(t=document.querySelector(t)),this.setContext(t),this.stageWidth=t.offsetWidth,this.stageHeight=t.offsetHeight,this.data=e,this.callStack=[],this.setDefaults();throw new Error("Sketchable requires a DOM element or selector.")}e.prototype={setContext:function(t){if(t)return this.canvas=t,this.context=t.getContext("2d"),this;throw new Error("No canvas element specified.")},setDefaults:function(){var t,e={fillStyle:this.data.fillStyle||"#F00",strokeStyle:this.data.strokeStyle||"#F0F",lineWidth:this.data.lineWidth||2,lineCap:this.data.lineCap||"round",lineJoin:this.data.lineJoin||"round",miterLimit:this.data.miterLimit||10};for(t in e)this.callStack.push({property:t,value:e[t]});return this.saveGraphics(e).restoreGraphics()},size:function(t,e){t=parseFloat(t),e=parseFloat(e);return this.stageWidth=t,this.stageHeight=e,this.canvas.width=t,this.canvas.height=e,this.restoreGraphics(),this},background:function(t){var e=[0,0,this.stageWidth,this.stageHeight];return this.beginFill(t),this.context.fillRect.apply(this.context,e),this.endFill(),this.callStack.push({property:"fillStyle",value:t}),this.callStack.push({method:"fillRect",args:e}),this},stage:function(t,e,i){return this.size(t,e).background(i),this},beginFill:function(t){return this.saveGraphics({fillStyle:t}),this.context.fillStyle=t,this.callStack.push({property:"fillStyle",value:t}),this},endFill:function(){return this.restoreGraphics(),this},lineStyle:function(t,e,i,s,h){return this.saveGraphics({strokeStyle:t,lineWidth:e,lineCap:i,lineJoin:s,miterLimit:h}).restoreGraphics()},moveTo:function(t,e){var i=[].slice.call(arguments);return this.context.moveTo.apply(this.context,i),this.callStack.push({method:"moveTo",args:i}),this},lineTo:function(t,e){var i=[].slice.call(arguments);return this.context.lineTo.apply(this.context,i),this.callStack.push({method:"lineTo",args:i}),this},line:function(t,e,i,s){return this.moveTo(t,e),this.lineTo(i,s),this},curveTo:function(t,e,i,s){i=[i,s,t,e];return this.context.quadraticCurveTo.apply(this.context,i),this.callStack.push({method:"quadraticCurveTo",args:i}),this},curve:function(t,e,i,s,h,a){return this.moveTo(t,e),this.curveTo(i,s,h,a),this},stroke:function(){return this.context.stroke(),this.callStack.push({method:"stroke"}),this},strokeRect:function(t,e,i,s){var h=[].slice.call(arguments);return this.context.beginPath(),this.context.strokeRect.apply(this.context,h),this.context.closePath(),this.callStack.push({method:"strokeRect",args:h}),this},fillRect:function(t,e,i,s){var h=[].slice.call(arguments);return this.context.beginPath(),this.context.fillRect.apply(this.context,h),this.context.closePath(),this.callStack.push({method:"fillRect",args:h}),this},rect:function(t,e,i,s){var h=[].slice.call(arguments);return this.fillRect.apply(this,h),this.strokeRect.apply(this,h),this},strokeCircle:function(t,e,i){t=[t,e,i,0,2*Math.PI,!1];return this.context.beginPath(),this.context.arc.apply(this.context,t),this.context.stroke(),this.context.closePath(),this.callStack.push({method:"strokeCircle",args:t}),this},fillCircle:function(t,e,i){t=[t,e,i,0,2*Math.PI,!1];return this.context.beginPath(),this.context.arc.apply(this.context,t),this.context.fill(),this.context.closePath(),this.callStack.push({method:"fillCircle",args:t}),this},circle:function(t,e,i){var s=[].slice.call(arguments);return this.fillCircle.apply(this,s),this.strokeCircle.apply(this,s),this},radialCircle:function(t,e,i,s,h){var a=this.context.createRadialGradient(t,e,i,t,e,s=void 0===s||s<0?1:s);h&&"array"===h.constructor.name.toLowerCase()||(h=[this.context.fillStyle,"white"]);for(var r=0;r<h.length;r++){var o=h[r];a.addColorStop(r,o)}return this.beginFill(a).fillCircle(t,e,i).endFill(),this},beginPath:function(){return this.context.beginPath(),this.callStack.push({method:"beginPath"}),this},closePath:function(){return this.context.closePath(),this.callStack.push({method:"closePath"}),this},eraser:function(){return this.context.globalCompositeOperation="destination-out",this.callStack.push({property:"comp-op",value:"dst_out"}),this},pencil:function(){return this.context.globalCompositeOperation="source-over",this.callStack.push({property:"comp-op",value:"src_over"}),this},clear:function(){var t=[0,0,this.stageWidth,this.stageHeight];return this.context.clearRect.apply(this.context,t),this.callStack.push({method:"clear"}),this},save:function(){return this.context.save(),this.callStack.push({method:"save"}),this},restore:function(){return this.context.restore(),this.callStack.push({method:"restore"}),this},saveGraphics:function(t){for(var e in t){var i=t[e];i&&i!==this.data[e]&&(this.data[e]=i,this.callStack.push({property:e,value:i}))}return this},restoreGraphics:function(){for(var t in this.data)this.context[t]=this.data[t];return this},drawImage:function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var s=this,h=new Image;return h.src=t,h.onload=function(){s.context.drawImage(h,e,i),s.callStack.push({method:"drawImage",args:[h,e,i]}),s.callStack.push({method:"removeAsync"})},h.onerror=function(){s.callStack.push({method:"removeAsync"})},s.callStack.push({method:"addAsync"}),this}},t.jSketch=e}(this);
!function(){var m="sketchable";function r(o){for(var s,e=dataBind(o.elem)[m],c=e.sketch,t=e.strokes,e=(e.options.events,e.options.graphics),l=[],n=0;n<t.length;n++)for(var a=t[n],i=0;i<a.length;i++){var r=(r=a[i])instanceof Array?{x:r[0],y:r[1],time:r[2],strokeId:r[4]}:r;r.strokeId||(r.strokeId=n),l.push(r)}o.trigger("animationstart");var d=0;c.lineStyle(e.strokeStyle,e.lineWidth),function e(){s=requestAnimationFrame(e);try{var t,n=c,a=d,i=(r=l)[a],r=r[a+1];0!==a&&i.strokeId===r.strokeId||(n.data.firstPointSize&&(t=0<a?r:i,n.beginFill(n.data.strokeStyle).fillCircle(t.x,t.y,n.data.firstPointSize).endFill()),0<a&&o.trigger("animationstep"),n.closePath().beginPath()),i.strokeId===r.strokeId&&n.line(i.x,i.y,r.x,r.y).stroke()}catch(e){console.error(e),cancelAnimationFrame(s)}++d==l.length-1&&(cancelAnimationFrame(s),o.trigger("animationend"))}(),this.cancel=function(){return cancelAnimationFrame(s),this}}Sketchable.prototype.plugins.animate=function(e){for(var t={clear:function(e,t){t.animate&&t.animate.cancel()},destroy:function(e,t){t.animate&&t.animate.cancel()}},n="clear destroy".split(" "),a=0;a<n.length;a++){var i=n[a];e.decorate(i,t[i],"animate")}deepExtend(e,{animate:{strokes:function(){return dataBind(e.elem)[m].animate=new r(e),e}}})}}();
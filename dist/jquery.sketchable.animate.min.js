!function(r){var k="sketchable";function o(o){for(var s,e=o.data(k),c=e.sketch,t=e.strokes,e=(e.options.events,e.options.graphics),l=[],a=0;a<t.length;a++)for(var n=t[a],i=0;i<n.length;i++){var r=(r=n[i])instanceof Array?{x:r[0],y:r[1],time:r[2],strokeId:r[4]}:r;r.strokeId||(r.strokeId=a),l.push(r)}o.sketchable("trigger","animationstart");var h=0;c.lineStyle(e.strokeStyle,e.lineWidth),function e(){s=requestAnimationFrame(e);try{var t,a=c,n=h,i=(r=l)[n],r=r[n+1];0!==n&&i.strokeId===r.strokeId||(a.data.firstPointSize&&(t=0<n?r:i,a.beginFill(a.data.strokeStyle).fillCircle(t.x,t.y,a.data.firstPointSize).endFill()),0<n&&o.sketchable("trigger","animationstep"),a.closePath().beginPath()),i.strokeId===r.strokeId&&a.line(i.x,i.y,r.x,r.y).stroke()}catch(e){console.error(e),cancelAnimationFrame(s)}++h==l.length-1&&(cancelAnimationFrame(s),o.sketchable("trigger","animationend"))}(),this.cancel=function(){return cancelAnimationFrame(s),this}}r.fn.sketchable.plugins.animate=function(e){for(var t={clear:function(e,t){t.animate&&t.animate.cancel()},destroy:function(e,t){t.animate&&t.animate.cancel()}},a="clear destroy".split(" "),n=0;n<a.length;n++){var i=a[n];e.sketchable("decorate",i,t[i],"animate")}r.extend(r.fn.sketchable.api,{animate:{strokes:function(){return r(this).data(k).animate=new o(e),e}}})}}(jQuery);
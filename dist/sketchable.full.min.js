/*! jSketch drawing lib (all in one) | v2.0.1 | 2022-12-09 */
!function(t){function e(t,e){if(t)return"string"==typeof t&&(t=document.querySelector(t)),this.setContext(t),this.stageWidth=t.offsetWidth,this.stageHeight=t.offsetHeight,this.data=e,this.callStack=[],this.setDefaults();throw new Error("Sketchable requires a DOM element or selector.")}e.prototype={setContext:function(t){if(t)return this.canvas=t,this.context=t.getContext("2d"),this;throw new Error("No canvas element specified.")},setDefaults:function(){var t,e={fillStyle:this.data.fillStyle||"#F00",strokeStyle:this.data.strokeStyle||"#F0F",lineWidth:this.data.lineWidth||2,lineCap:this.data.lineCap||"round",lineJoin:this.data.lineJoin||"round",miterLimit:this.data.miterLimit||10};for(t in e)this.callStack.push({property:t,value:e[t]});return this.saveGraphics(e).restoreGraphics()},size:function(t,e){t=parseFloat(t),e=parseFloat(e);return this.stageWidth=t,this.stageHeight=e,this.canvas.width=t,this.canvas.height=e,this.restoreGraphics(),this},background:function(t){var e=[0,0,this.stageWidth,this.stageHeight];return this.beginFill(t),this.context.fillRect.apply(this.context,e),this.endFill(),this.callStack.push({property:"fillStyle",value:t}),this.callStack.push({method:"fillRect",args:e}),this},stage:function(t,e,n){return this.size(t,e).background(n),this},beginFill:function(t){return this.saveGraphics({fillStyle:t}),this.context.fillStyle=t,this.callStack.push({property:"fillStyle",value:t}),this},endFill:function(){return this.restoreGraphics(),this},lineStyle:function(t,e,n,i,o){return this.saveGraphics({strokeStyle:t,lineWidth:e,lineCap:n,lineJoin:i,miterLimit:o}).restoreGraphics()},moveTo:function(t,e){var n=[].slice.call(arguments);return this.context.moveTo.apply(this.context,n),this.callStack.push({method:"moveTo",args:n}),this},lineTo:function(t,e){var n=[].slice.call(arguments);return this.context.lineTo.apply(this.context,n),this.callStack.push({method:"lineTo",args:n}),this},line:function(t,e,n,i){return this.moveTo(t,e),this.lineTo(n,i),this},curveTo:function(t,e,n,i){n=[n,i,t,e];return this.context.quadraticCurveTo.apply(this.context,n),this.callStack.push({method:"quadraticCurveTo",args:n}),this},curve:function(t,e,n,i,o,r){return this.moveTo(t,e),this.curveTo(n,i,o,r),this},stroke:function(){return this.context.stroke(),this.callStack.push({method:"stroke"}),this},strokeRect:function(t,e,n,i){var o=[].slice.call(arguments);return this.context.beginPath(),this.context.strokeRect.apply(this.context,o),this.context.closePath(),this.callStack.push({method:"strokeRect",args:o}),this},fillRect:function(t,e,n,i){var o=[].slice.call(arguments);return this.context.beginPath(),this.context.fillRect.apply(this.context,o),this.context.closePath(),this.callStack.push({method:"fillRect",args:o}),this},rect:function(t,e,n,i){var o=[].slice.call(arguments);return this.fillRect.apply(this,o),this.strokeRect.apply(this,o),this},strokeCircle:function(t,e,n){t=[t,e,n,0,2*Math.PI,!1];return this.context.beginPath(),this.context.arc.apply(this.context,t),this.context.stroke(),this.context.closePath(),this.callStack.push({method:"strokeCircle",args:t}),this},fillCircle:function(t,e,n){t=[t,e,n,0,2*Math.PI,!1];return this.context.beginPath(),this.context.arc.apply(this.context,t),this.context.fill(),this.context.closePath(),this.callStack.push({method:"fillCircle",args:t}),this},circle:function(t,e,n){var i=[].slice.call(arguments);return this.fillCircle.apply(this,i),this.strokeCircle.apply(this,i),this},radialCircle:function(t,e,n,i,o){var r=this.context.createRadialGradient(t,e,n,t,e,i=void 0===i||i<0?1:i);o&&"array"===o.constructor.name.toLowerCase()||(o=[this.context.fillStyle,"white"]);for(var s=0;s<o.length;s++){var a=o[s];r.addColorStop(s,a)}return this.beginFill(r).fillCircle(t,e,n).endFill(),this},beginPath:function(){return this.context.beginPath(),this.callStack.push({method:"beginPath"}),this},closePath:function(){return this.context.closePath(),this.callStack.push({method:"closePath"}),this},eraser:function(){return this.context.globalCompositeOperation="destination-out",this.callStack.push({property:"comp-op",value:"dst_out"}),this},pencil:function(){return this.context.globalCompositeOperation="source-over",this.callStack.push({property:"comp-op",value:"src_over"}),this},clear:function(){var t=[0,0,this.stageWidth,this.stageHeight];return this.context.clearRect.apply(this.context,t),this.callStack.push({method:"clear"}),this},save:function(){return this.context.save(),this.callStack.push({method:"save"}),this},restore:function(){return this.context.restore(),this.callStack.push({method:"restore"}),this},saveGraphics:function(t){for(var e in t){var n=t[e];n&&n!==this.data[e]&&(this.data[e]=n,this.callStack.push({property:e,value:n}))}return this},restoreGraphics:function(){for(var t in this.data)this.context[t]=this.data[t];return this},drawImage:function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0);var i=this,o=new Image;return o.src=t,o.onload=function(){i.context.drawImage(o,e,n),i.callStack.push({method:"drawImage",args:[o,e,n]}),i.callStack.push({method:"removeAsync"})},o.onerror=function(){i.callStack.push({method:"removeAsync"})},i.callStack.push({method:"addAsync"}),this}},t.jSketch=e}(this),function(t){t.jSketch.prototype.toSVG=function(e){if("function"!=typeof e)throw new Error("You must supply a callback in toSVG() method.");var i=this,o=[],n=0,r={},s={addAsync:function(){return n++,""},removeAsync:function(){return n--,""},drawImage:function(t,e,n){return'<image preserveAspectRatio="none"           width="'+t.width+'"           height="'+t.height+'"           transform="translate('+e+", "+n+')"           xlink:href="'+t.src+'"></image>'},fillRect:function(t,e,n,i){return'<rect stroke="none"           width="'+n+'"           height="'+i+'"           x="'+t+'"           y="'+e+'"           fill="'+r.fillStyle+'"></rect>'},strokeRect:function(t,e,n,i){return'<rect fill="none"           width="'+n+'"           height="'+i+'"           x="'+t+'"           y="'+e+'"           stroke="'+r.strokeStyle+'"           stroke-width="'+r.lineWidth+'"           stroke-linecap="'+r.lineCap+'"           stroke-linejoin="'+r.lineJoin+'"           stroke-miterlimit="'+r.miterLimit+'"></rect>'},strokeCircle:function(t,e,n){return'<circle fill="none"           cx="'+t+'"           cy="'+e+'"           r="'+n+'"           stroke="'+r.strokeStyle+'"           stroke-width="'+r.lineWidth+'" />'},fillCircle:function(t,e,n){return'<circle stroke="none"           cx="'+t+'"           cy="'+e+'"           r="'+n+'"           fill="'+r.fillStyle+'" />'},beginPath:function(){return o=[],""},closePath:function(){var t="";return 0<o.length&&(t='<path fill="none"             stroke="'+r.strokeStyle+'"             stroke-width="'+r.lineWidth+'"             stroke-linecap="'+r.lineCap+'"             stroke-linejoin="'+r.lineJoin+'"             stroke-miterlimit="'+r.miterLimit+'"             d="'+o.join(" ")+'" />',o=[]),t},moveTo:function(t,e){return o.push("M "+t+" "+e),""},lineTo:function(t,e){return o.push("L "+t+" "+e),""},quadraticCurveTo:function(t,e,n,i){return o.push("Q "+t+" "+e+" "+n+" "+i),""}};function a(){var t='<?xml version="1.0" encoding="utf-8" standalone="no" ?>';return(t=(t=(t=(t=(t+='<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"         "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">')+('<svg version="1.1"         xmlns="http://www.w3.org/2000/svg"         xmlns:svg="http://www.w3.org/2000/svg"         xmlns:xlink="http://www.w3.org/1999/xlink"         width="'+i.stageWidth+'"         height="'+i.stageHeight+'"         viewBox="0 0 '+i.stageWidth+" "+i.stageHeight+'">')+"<desc>Generated with jSketch: https://luis.leiva.name/jsketch/</desc>")+"<defs></defs>"+"<g>")+function(){for(var t="",e=0;e<i.callStack.length;e++){var n=i.callStack[e];n.property&&"object"!=typeof n.value?r[n.property]=n.value:n.method?s[n.method]?t+=s[n.method].apply(null,n.args):console.warn("Method not implemented:",n.method):console.warn("Unknown call:",n)}return t}())+"</g>"+"</svg>").replace(/\s+/g," ")}var c=setInterval(function(){{var t;n<=0?(clearInterval(c),t=a(),e(t)):console.info("Waiting for %s async operations to be finished ...",n)}},150);return this}}(this),function(){var n=[0],i="data"+Date.now();window.dataBind=function(t){var e=t[i];return e||(e=t[i]=n.length,n[e]={}),n[e]}}(),window.Event={add:function(t,e,n){if(!t)return!1;(t="string"==typeof t?document.querySelector(t):t).addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t[e+n]=function(){n(window.event)}},remove:function(t,e,n){if(!t)return!1;(t="string"==typeof t?document.querySelector(t):t).removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on"+e,n):t[e+n]=null},isRightClick:function(t){return(t=t||window.event).which?3===t.which:!!t.button&&2===e.button}},window.deepExtend=function(t){t=t||{};for(var e=1;e<arguments.length;e++){var n,i=arguments[e];for(n in i)i.hasOwnProperty(n)&&("object"==typeof i[n]?t[n]=deepExtend(t[n],i[n]):t[n]=i[n])}return t},function(c){var p="sketchable",l=c.document;function o(t,e){if(t)return"string"==typeof t&&(t=l.querySelector(t)),this.elem=t,this.init(e);throw new Error("Sketchable requires a DOM element.")}function r(t,e){(e=e||dataBind(t)[p].options).cssCursors&&(t.style.cursor=e.interactive?"pointer":"not-allowed"),t.onselectstart=function(){return!1}}function h(t){var e,n,i,o=t.target,r=(s=(s=o).getBoundingClientRect(),e=l.body,n=l.documentElement,i=c.pageYOffset||n.scrollTop||e.scrollTop,a=c.pageXOffset||n.scrollLeft||e.scrollLeft,r=n.clientTop||e.clientTop||0,n=n.clientLeft||e.clientLeft||0,e=s.top+i-r,i=s.left+a-n,{top:Math.round(e),left:Math.round(i)}),s=o.width/o.offsetWidth,a=o.height/o.offsetHeight;return{x:Math.round((t.pageX-r.left)*s),y:Math.round((t.pageY-r.top)*a),time:Date.now()}}function u(t,e,n){var i=e.coords[t];e.options.relTimestamps&&(0===e.strokes.length&&0===i.length&&(e.timestamp=n.time),n.time-=e.timestamp),i.push([n.x,n.y,n.time,+e.sketch.isDrawing,t]),e.options.filterCoords&&1<i.length&&(t=i[n=i.length-1],e=i[n-1],t[0]==e[0])&&t[1]==e[1]&&i.splice(n,1)}function s(t){if(t.touches)return!1;e(t)}function a(t){if(t.touches)return!1;n(t)}function d(t){if(t.touches)return!1;i(t)}function f(t){g(t,e),t.preventDefault()}function m(t){g(t,n),t.preventDefault()}function v(t){g(t,i),t.preventDefault()}function e(t){if(Event.isRightClick(t))return!1;var e,n,i=Math.abs(t.identifier||0),o=t.target,r=dataBind(o)[p],s=r.options;s.interactive&&(e=h(t),"function"==typeof s.events.mousedownBefore&&s.events.mousedownBefore(o,r,t),0<s.graphics.firstPointSize&&r.sketch.beginFill(s.graphics.fillStyle).fillCircle(e.x,e.y,s.graphics.firstPointSize).endFill(),r.sketch.isDrawing=!0,r.sketch.beginPath(),0<(n=(n=r.coords[i])||[]).length&&r.strokes.push(n),r.coords[i]=[],u(i,r,e),"function"==typeof s.events.mousedown)&&s.events.mousedown(o,r,t)}function n(t){var e,n,i,o,r=Math.abs(t.identifier||0),s=t.target,a=dataBind(s)[p],c=a.options;c.interactive&&(c.mouseupMovements&&0!==a.strokes.length||a.sketch.isDrawing)&&(e=h(t),"function"==typeof c.events.mousemoveBefore&&c.events.mousemoveBefore(s,a,t),(n=(n=a.coords[r])[n.length-1])&&(a.sketch.isDrawing?(i=c.graphics.strokeStyle,o=c.graphics.lineWidth):c.mouseupMovements&&(i=c.mouseupMovements.strokeStyle||"#DDD",o=c.mouseupMovements.lineWidth||1),a.sketch.lineStyle(i,o).line(n[0],n[1],e.x,e.y).stroke()),u(r,a,e),"function"==typeof c.events.mousemove)&&c.events.mousemove(s,a,t)}function i(t){var e=Math.abs(t.identifier||0),n=t.target,i=dataBind(n)[p],o=i.options;o.interactive&&("function"==typeof o.events.mouseupBefore&&o.events.mouseupBefore(n,i,t),i.sketch.isDrawing=!1,i.sketch.closePath(),i.strokes.push(i.coords[e]),i.coords[e]=[],"function"==typeof o.events.mouseup)&&o.events.mouseup(n,i,t)}function g(t,e){var n=t.target,n=dataBind(n)[p].options;if(n.multitouch)for(var i,o=t.changedTouches,r=0;r<o.length;r++)k(i=o[r],t),e(i);else k(i=t.touches[0],t),e(i);t.preventDefault()}function k(t,e){t.type||(t.type=e.type)}(o.prototype={init:function(t){var e,t=deepExtend({},o.prototype.defaults,t||{}),n=this.elem,i=(dataBind(n)[p]||(Event.add(n,"mousedown",s),Event.add(n,"mousemove",a),Event.add(n,"mouseup",d),Event.add(n,"touchstart",f),Event.add(n,"touchmove",m),Event.add(n,"touchend",v),r(n,t)),new jSketch(n,t.graphics));for(e in dataBind(n)[p]=i={strokes:[],coords:{},timestamp:0,sketch:i,instance:this,options:t},"function"==typeof t.events.init&&t.events.init(n,i),this.plugins)this.plugins[e](this);return this},config:function(t){var e=this.elem,n=dataBind(e)[p];return t?(n.options=deepExtend({},o.prototype.defaults,n.options,t),r(e),this):n.options},data:function(t){var e=this.elem,e=dataBind(e)[p];return t?e[t]:e},strokes:function(t){var e=this.elem,n=dataBind(e)[p];if(t){n.strokes=t;var i=dataBind(e)[p],o=i.options,r=i.sketch;r.clear();for(var s,a,c=0;c<i.strokes.length;c++)for(var l=i.strokes[c],h=0;h<l.length;h++){var u=l[h],d=l[h+1],f=!0;if(!(f=3<u.length?1===u[3]:f)&&!o.mouseupMovements)break;0===h?(0<o.graphics.firstPointSize&&r.beginFill(o.graphics.fillStyle).fillCircle(u[0],u[1],o.graphics.firstPointSize).endFill(),f?(s=o.graphics.strokeStyle,a=o.graphics.lineWidth):o.mouseupMovements&&(s=o.mouseupMovements.strokeStyle||"#DDD",a=o.mouseupMovements.lineWidth||1),r.lineStyle(s,a)):d&&r.beginPath().line(u[0],u[1],d[0],d[1]).stroke().closePath()}return this}return n.strokes},handler:function(t){var e=this.elem;return t(e,dataBind(e)[p]),this},trigger:function(t){var e=this.elem,n=dataBind(e)[p],i=n.options.events;return i&&"function"==typeof i[t]&&i[t](e,n),this},clear:function(t){var e=this.elem,n=dataBind(e)[p],i=n.options;return n.sketch.clear(),t||(n.strokes=[],n.coords={}),"function"==typeof i.events.clear&&i.events.clear(e,n),this},reset:function(t){var e=this.elem,n=dataBind(e)[p],i=n.options;return this.destroy().init(t),"function"==typeof i.events.reset&&i.events.reset(e,n),this},destroy:function(){var t=this.elem,e=dataBind(t)[p],n=e.options;return Event.remove(t,"mouseup",d),Event.remove(t,"mousemove",a),Event.remove(t,"mousedown",s),Event.remove(t,"touchstart",f),Event.remove(t,"touchmove",m),Event.remove(t,"touchend",v),"function"==typeof n.events.destroy&&n.events.destroy(t,e),dataBind(t)[p]=null,this},decorate:function(t,e,n){var i,o=this.elem,o=dataBind(o)[p],r=o.options,n="_bound$"+t+"."+n;if(!o[n])return o[n]=!0,r.events&&"function"==typeof r.events[t]?(i=r.events[t],r.events[t]=function(){i.apply(this,arguments),e.apply(this,arguments)}):r.events[t]=e,this}}).plugins={},o.prototype.defaults={interactive:!0,mouseupMovements:!1,relTimestamps:!1,multitouch:!0,cssCursors:!0,filterCoords:!1,events:{},graphics:{firstPointSize:3,lineWidth:3,strokeStyle:"#F0F",fillStyle:"#F0F",lineCap:"round",lineJoin:"round",miterLimit:10}},c.Sketchable=o}(this),function(){var s="sketchable";function a(o){var i=[],r=-1,e=this;function n(n){o.handler(function(t,e){n&&0<n.identifier?i[r].strokes=e.strokes.slice():(i.push({image:t.toDataURL(),strokes:e.strokes.slice(),callStack:e.sketch.callStack.slice()}),r++)})}function t(t){if(t.ctrlKey)switch(t.which){case 26:t.shiftKey?e.redo():e.undo();break;case 25:e.redo()}}this.undo=function(){return 0<r&&(r--,this.restore(),o.trigger("mementoundo")),this},this.redo=function(){return r<i.length-1&&(r++,this.restore(),o.trigger("mementoredo")),this},this.reset=function(){return i=[],r=-1,n(),this},this.save=function(t){return n(t),o.trigger("mementosave"),this},this.state=function(){return JSON.parse(JSON.stringify(i[r]))},this.restore=function(t){t=t||i[r];var e=new Image;return e.src=t.image,e.onload=function(){var n,i;n=this,i=t,o.handler(function(t,e){e.sketch.clear(),e.sketch.context.drawImage(n,0,0),e.strokes=i.strokes.slice(),e.sketch.callStack=i.callStack.slice()}),o.trigger("mementochange")},this},this.init=function(){return Event.remove(document,"keypress",t),Event.add(document,"keypress",t),o.trigger("mementoinit"),n(),this},this.destroy=function(){return Event.remove(document,"keypress",t),o.trigger("mementodestroy"),this.reset()}}Sketchable.prototype.plugins.memento=function(e){for(var t={clear:function(t,e){e.memento.reset()},mouseup:function(t,e,n){e.memento.save(n)},destroy:function(t,e){e.memento.destroy()}},n="mouseup clear destroy".split(" "),i=0;i<n.length;i++){var o=n[i];e.decorate(o,t[o],"memento")}deepExtend(e,{memento:{undo:function(){return dataBind(e.elem)[s].memento.undo(),e},redo:function(){return dataBind(e.elem)[s].memento.redo(),e},save:function(){return dataBind(e.elem)[s].memento.save(),e},state:function(){return dataBind(e.elem)[s].memento.state()},restore:function(t){return dataBind(e.elem)[s].memento.restore(t),e}}});var r=dataBind(e.elem)[s];r.memento=new a(e),r.memento.init()}}(),function(){var u="sketchable";function r(s){for(var a,t=dataBind(s.elem)[u],c=t.sketch,e=t.strokes,t=(t.options.events,t.options.graphics),l=[],n=0;n<e.length;n++)for(var i=e[n],o=0;o<i.length;o++){var r=(r=i[o])instanceof Array?{x:r[0],y:r[1],time:r[2],strokeId:r[4]}:r;r.strokeId||(r.strokeId=n),l.push(r)}s.trigger("animationstart");var h=0;c.lineStyle(t.strokeStyle,t.lineWidth),function t(){a=requestAnimationFrame(t);try{var e,n=c,i=h,o=(r=l)[i],r=r[i+1];0!==i&&o.strokeId===r.strokeId||(n.data.firstPointSize&&(e=0<i?r:o,n.beginFill(n.data.strokeStyle).fillCircle(e.x,e.y,n.data.firstPointSize).endFill()),0<i&&s.trigger("animationstep"),n.closePath().beginPath()),o.strokeId===r.strokeId&&n.line(o.x,o.y,r.x,r.y).stroke()}catch(t){console.error(t),cancelAnimationFrame(a)}++h==l.length-1&&(cancelAnimationFrame(a),s.trigger("animationend"))}(),this.cancel=function(){return cancelAnimationFrame(a),this}}Sketchable.prototype.plugins.animate=function(t){for(var e={clear:function(t,e){e.animate&&e.animate.cancel()},destroy:function(t,e){e.animate&&e.animate.cancel()}},n="clear destroy".split(" "),i=0;i<n.length;i++){var o=n[i];t.decorate(o,e[o],"animate")}deepExtend(t,{animate:{strokes:function(){return dataBind(t.elem)[u].animate=new r(t),t}}})}}(),function(){var a="sketchable";Sketchable.prototype.plugins.serializer=function(s){deepExtend(s,{serializer:{save:function(){var t=dataBind(s.elem)[a];return JSON.stringify({options:t.options,strokes:t.strokes,actions:t.sketch.callStack})},load:function(t){for(var e=dataBind(s.elem)[a],n=JSON.parse(t),i=e.sketch,o=0;o<n.actions.length;o++){var r=n.actions[o];r.property&&"object"!=typeof r.value?i.data[r.property]=r.value:r.method?i[r.method].apply(i,r.args):console.warn("Unknown call:",r)}return e.sketch.callStack=n.actions.slice(),e.strokes=n.strokes.slice(),e.options=n.options,s}}})}}(),Sketchable.prototype.plugins.svg=function(e){for(var t={clear:function(t,e){e.sketch.callStack=[]},destroy:function(t,e){e.sketch.callStack=[]}},n="clear destroy".split(" "),i=0;i<n.length;i++){var o=n[i];e.decorate(o,t[o],"svg")}deepExtend(e,{svg:{create:function(t){return dataBind(e.elem).sketchable.sketch.toSVG(t),e}}})};